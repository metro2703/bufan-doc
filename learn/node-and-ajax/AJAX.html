<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>AJAX | 不凡学院前端100天</title>
    <meta name="description" content="快速上手,循序渐进">
    <link rel="icon" href="/bufan-doc/logo.jpg">
  <link rel="manifest" href="/bufan-doc/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/bufan-doc/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/bufan-doc/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/bufan-doc/assets/css/0.styles.4fc22246.css" as="style"><link rel="preload" href="/bufan-doc/assets/js/app.f4cc6427.js" as="script"><link rel="preload" href="/bufan-doc/assets/js/4.d60abc91.js" as="script"><link rel="preload" href="/bufan-doc/assets/js/3.08e48031.js" as="script"><link rel="preload" href="/bufan-doc/assets/js/88.23a39bc5.js" as="script"><link rel="preload" href="/bufan-doc/assets/js/14.618a24b7.js" as="script"><link rel="prefetch" href="/bufan-doc/assets/js/10.3b8a5562.js"><link rel="prefetch" href="/bufan-doc/assets/js/100.4ba68262.js"><link rel="prefetch" href="/bufan-doc/assets/js/101.6db92bf8.js"><link rel="prefetch" href="/bufan-doc/assets/js/102.01d55fe2.js"><link rel="prefetch" href="/bufan-doc/assets/js/103.4104b1e2.js"><link rel="prefetch" href="/bufan-doc/assets/js/104.af35539f.js"><link rel="prefetch" href="/bufan-doc/assets/js/105.64f144d2.js"><link rel="prefetch" href="/bufan-doc/assets/js/106.1ad49cc0.js"><link rel="prefetch" href="/bufan-doc/assets/js/107.b3243d38.js"><link rel="prefetch" href="/bufan-doc/assets/js/108.e4f06cdf.js"><link rel="prefetch" href="/bufan-doc/assets/js/109.f82c6f4f.js"><link rel="prefetch" href="/bufan-doc/assets/js/11.dabd9edf.js"><link rel="prefetch" href="/bufan-doc/assets/js/110.43ef8a19.js"><link rel="prefetch" href="/bufan-doc/assets/js/111.8d21dabd.js"><link rel="prefetch" href="/bufan-doc/assets/js/112.97d55372.js"><link rel="prefetch" href="/bufan-doc/assets/js/113.17be5afc.js"><link rel="prefetch" href="/bufan-doc/assets/js/114.7c7c0031.js"><link rel="prefetch" href="/bufan-doc/assets/js/115.6191c96c.js"><link rel="prefetch" href="/bufan-doc/assets/js/116.f8406fce.js"><link rel="prefetch" href="/bufan-doc/assets/js/117.7e6ced5f.js"><link rel="prefetch" href="/bufan-doc/assets/js/118.95f2b2c6.js"><link rel="prefetch" href="/bufan-doc/assets/js/119.656fb4a6.js"><link rel="prefetch" href="/bufan-doc/assets/js/12.28f15829.js"><link rel="prefetch" href="/bufan-doc/assets/js/120.884f6058.js"><link rel="prefetch" href="/bufan-doc/assets/js/121.1ea98fcd.js"><link rel="prefetch" href="/bufan-doc/assets/js/122.ff3c9d25.js"><link rel="prefetch" href="/bufan-doc/assets/js/123.2d0a0879.js"><link rel="prefetch" href="/bufan-doc/assets/js/124.dbee8ca1.js"><link rel="prefetch" href="/bufan-doc/assets/js/125.fe02abe6.js"><link rel="prefetch" href="/bufan-doc/assets/js/126.ea7f7bb5.js"><link rel="prefetch" href="/bufan-doc/assets/js/127.606c2de1.js"><link rel="prefetch" href="/bufan-doc/assets/js/128.0f2b467b.js"><link rel="prefetch" href="/bufan-doc/assets/js/129.97cbaeca.js"><link rel="prefetch" href="/bufan-doc/assets/js/13.83be0207.js"><link rel="prefetch" href="/bufan-doc/assets/js/15.671b0072.js"><link rel="prefetch" href="/bufan-doc/assets/js/16.6425c53e.js"><link rel="prefetch" href="/bufan-doc/assets/js/17.f748524f.js"><link rel="prefetch" href="/bufan-doc/assets/js/18.dae45be7.js"><link rel="prefetch" href="/bufan-doc/assets/js/19.a61fe4f0.js"><link rel="prefetch" href="/bufan-doc/assets/js/20.80399a10.js"><link rel="prefetch" href="/bufan-doc/assets/js/21.d424c18b.js"><link rel="prefetch" href="/bufan-doc/assets/js/22.5d82a21d.js"><link rel="prefetch" href="/bufan-doc/assets/js/23.36b6d0a0.js"><link rel="prefetch" href="/bufan-doc/assets/js/24.b2436ce4.js"><link rel="prefetch" href="/bufan-doc/assets/js/25.d0c6e25f.js"><link rel="prefetch" href="/bufan-doc/assets/js/26.b5e3c19c.js"><link rel="prefetch" href="/bufan-doc/assets/js/27.a524df1a.js"><link rel="prefetch" href="/bufan-doc/assets/js/28.25c0ed5e.js"><link rel="prefetch" href="/bufan-doc/assets/js/29.f9b5a855.js"><link rel="prefetch" href="/bufan-doc/assets/js/30.67d39ab6.js"><link rel="prefetch" href="/bufan-doc/assets/js/31.92b1b15d.js"><link rel="prefetch" href="/bufan-doc/assets/js/32.f4e82e10.js"><link rel="prefetch" href="/bufan-doc/assets/js/33.8e078611.js"><link rel="prefetch" href="/bufan-doc/assets/js/34.b4bea20d.js"><link rel="prefetch" href="/bufan-doc/assets/js/35.24d90a48.js"><link rel="prefetch" href="/bufan-doc/assets/js/36.ef702182.js"><link rel="prefetch" href="/bufan-doc/assets/js/37.f5cc6f4f.js"><link rel="prefetch" href="/bufan-doc/assets/js/38.45b62383.js"><link rel="prefetch" href="/bufan-doc/assets/js/39.5351a017.js"><link rel="prefetch" href="/bufan-doc/assets/js/40.39da4318.js"><link rel="prefetch" href="/bufan-doc/assets/js/41.bc5678de.js"><link rel="prefetch" href="/bufan-doc/assets/js/42.f4a5cc7c.js"><link rel="prefetch" href="/bufan-doc/assets/js/43.83e2ec23.js"><link rel="prefetch" href="/bufan-doc/assets/js/44.4675ab38.js"><link rel="prefetch" href="/bufan-doc/assets/js/45.72d3f200.js"><link rel="prefetch" href="/bufan-doc/assets/js/46.8d77ad14.js"><link rel="prefetch" href="/bufan-doc/assets/js/47.7daeae21.js"><link rel="prefetch" href="/bufan-doc/assets/js/48.8c3532fd.js"><link rel="prefetch" href="/bufan-doc/assets/js/49.d2ceb345.js"><link rel="prefetch" href="/bufan-doc/assets/js/5.38bfdf08.js"><link rel="prefetch" href="/bufan-doc/assets/js/50.41300c4a.js"><link rel="prefetch" href="/bufan-doc/assets/js/51.7123e828.js"><link rel="prefetch" href="/bufan-doc/assets/js/52.96ab2ac5.js"><link rel="prefetch" href="/bufan-doc/assets/js/53.01bcfe44.js"><link rel="prefetch" href="/bufan-doc/assets/js/54.379a6e11.js"><link rel="prefetch" href="/bufan-doc/assets/js/55.05379669.js"><link rel="prefetch" href="/bufan-doc/assets/js/56.380aaeac.js"><link rel="prefetch" href="/bufan-doc/assets/js/57.5638cfe7.js"><link rel="prefetch" href="/bufan-doc/assets/js/58.4aaf9b06.js"><link rel="prefetch" href="/bufan-doc/assets/js/59.6db0022e.js"><link rel="prefetch" href="/bufan-doc/assets/js/6.2c430a05.js"><link rel="prefetch" href="/bufan-doc/assets/js/60.5b1ba8d4.js"><link rel="prefetch" href="/bufan-doc/assets/js/61.f226504c.js"><link rel="prefetch" href="/bufan-doc/assets/js/62.2563abf3.js"><link rel="prefetch" href="/bufan-doc/assets/js/63.94b44c4a.js"><link rel="prefetch" href="/bufan-doc/assets/js/64.2b0b61cf.js"><link rel="prefetch" href="/bufan-doc/assets/js/65.6d2830f1.js"><link rel="prefetch" href="/bufan-doc/assets/js/66.65a4cc01.js"><link rel="prefetch" href="/bufan-doc/assets/js/67.7b270307.js"><link rel="prefetch" href="/bufan-doc/assets/js/68.a8fe45f4.js"><link rel="prefetch" href="/bufan-doc/assets/js/69.8f88d229.js"><link rel="prefetch" href="/bufan-doc/assets/js/7.e6ecd274.js"><link rel="prefetch" href="/bufan-doc/assets/js/70.1ddc66b4.js"><link rel="prefetch" href="/bufan-doc/assets/js/71.77170c41.js"><link rel="prefetch" href="/bufan-doc/assets/js/72.1dc4049b.js"><link rel="prefetch" href="/bufan-doc/assets/js/73.7da3757c.js"><link rel="prefetch" href="/bufan-doc/assets/js/74.2181d25c.js"><link rel="prefetch" href="/bufan-doc/assets/js/75.be8d5dc6.js"><link rel="prefetch" href="/bufan-doc/assets/js/76.4cbdb224.js"><link rel="prefetch" href="/bufan-doc/assets/js/77.5ee263b6.js"><link rel="prefetch" href="/bufan-doc/assets/js/78.6b078925.js"><link rel="prefetch" href="/bufan-doc/assets/js/79.414db56b.js"><link rel="prefetch" href="/bufan-doc/assets/js/8.156e0c5d.js"><link rel="prefetch" href="/bufan-doc/assets/js/80.213572d0.js"><link rel="prefetch" href="/bufan-doc/assets/js/81.33f5de66.js"><link rel="prefetch" href="/bufan-doc/assets/js/82.d854fa6f.js"><link rel="prefetch" href="/bufan-doc/assets/js/83.110c252e.js"><link rel="prefetch" href="/bufan-doc/assets/js/84.473df94b.js"><link rel="prefetch" href="/bufan-doc/assets/js/85.ee0c2c9c.js"><link rel="prefetch" href="/bufan-doc/assets/js/86.ec58ee6e.js"><link rel="prefetch" href="/bufan-doc/assets/js/87.82972f59.js"><link rel="prefetch" href="/bufan-doc/assets/js/89.4be8b33a.js"><link rel="prefetch" href="/bufan-doc/assets/js/9.44c09d8c.js"><link rel="prefetch" href="/bufan-doc/assets/js/90.44c2861c.js"><link rel="prefetch" href="/bufan-doc/assets/js/91.468becad.js"><link rel="prefetch" href="/bufan-doc/assets/js/92.9e5ceb34.js"><link rel="prefetch" href="/bufan-doc/assets/js/93.9032fb68.js"><link rel="prefetch" href="/bufan-doc/assets/js/94.d7e6c360.js"><link rel="prefetch" href="/bufan-doc/assets/js/95.0fa635fb.js"><link rel="prefetch" href="/bufan-doc/assets/js/96.c7a82be8.js"><link rel="prefetch" href="/bufan-doc/assets/js/97.bf5ce894.js"><link rel="prefetch" href="/bufan-doc/assets/js/98.9d46ee61.js"><link rel="prefetch" href="/bufan-doc/assets/js/99.40ccc798.js"><link rel="prefetch" href="/bufan-doc/assets/js/vendors~notification.8531c786.js">
    <link rel="stylesheet" href="/bufan-doc/assets/css/0.styles.4fc22246.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-36ae5a00><header class="navbar" data-v-36ae5a00><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/bufan-doc/" class="home-link router-link-active"><!----> <span class="site-name">不凡学院前端100天</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/bufan-doc/learn/" class="nav-link router-link-active">学习教程</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">配套资料</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bufan-doc/learn/soft/" class="nav-link">前端工具</a></li><li class="dropdown-item"><!----> <a href="/bufan-doc/interview/" class="nav-link">面试之道</a></li></ul></div></div><div class="nav-item"><a href="http://www.bufanui.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  不凡官网
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/nevermo2013/dingpq" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask" data-v-36ae5a00></div> <aside class="sidebar" data-v-36ae5a00><nav class="nav-links"><div class="nav-item"><a href="/bufan-doc/learn/" class="nav-link router-link-active">学习教程</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">配套资料</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bufan-doc/learn/soft/" class="nav-link">前端工具</a></li><li class="dropdown-item"><!----> <a href="/bufan-doc/interview/" class="nav-link">面试之道</a></li></ul></div></div><div class="nav-item"><a href="http://www.bufanui.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  不凡官网
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/nevermo2013/dingpq" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <a href="http://www.bufanui.com" target="_blank" class="ads ads-top" data-v-36ae5a00><img src="/bufan-doc/assets/img/bf.b6eae9c3.jpg" alt="" class="ads-img" data-v-36ae5a00></a> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>起步</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/" class="sidebar-link">web 前端介绍</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HTML和CSS基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/html-and-css/01-网页初识.html" class="sidebar-link">网页初识</a></li><li><a href="/bufan-doc/learn/html-and-css/02-HTML初识.html" class="sidebar-link">HTML 初识</a></li><li><a href="/bufan-doc/learn/html-and-css/03-HTML常用标签.html" class="sidebar-link">HTML 常用标签</a></li><li><a href="/bufan-doc/learn/html-and-css/04-CSS初识.html" class="sidebar-link">CSS 初识</a></li><li><a href="/bufan-doc/learn/html-and-css/05-CSS盒子模型.html" class="sidebar-link">CSS 盒子模型</a></li><li><a href="/bufan-doc/learn/html-and-css/06-CSS常用布局.html" class="sidebar-link">CSS 常用布局</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript基础语法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/javascript/01-JavaScript初识.html" class="sidebar-link">JavaScript 初识</a></li><li><a href="/bufan-doc/learn/javascript/02-变量和数据类型.html" class="sidebar-link">变量和数据类型</a></li><li><a href="/bufan-doc/learn/javascript/03-数据类型转换.html" class="sidebar-link">数据类型转换</a></li><li><a href="/bufan-doc/learn/javascript/04-常用运算符.html" class="sidebar-link">常用运算符</a></li><li><a href="/bufan-doc/learn/javascript/05-Date和Math对象.html" class="sidebar-link">Date 和 Math 对象</a></li><li><a href="/bufan-doc/learn/javascript/06-流程控制语句.html" class="sidebar-link">流程控制语句</a></li><li><a href="/bufan-doc/learn/javascript/07-数组初识.html" class="sidebar-link">数组初识</a></li><li><a href="/bufan-doc/learn/javascript/08-函数初识.html" class="sidebar-link">函数初识</a></li><li><a href="/bufan-doc/learn/javascript/09-排序和递归算法.html" class="sidebar-link">排序和递归</a></li><li><a href="/bufan-doc/learn/javascript/10-对象初识.html" class="sidebar-link">对象初识</a></li><li><a href="/bufan-doc/learn/javascript/11-数组和字符串常用方法.html" class="sidebar-link">数组和字符串常用方法</a></li><li><a href="/bufan-doc/learn/javascript/12-垃圾回收机制.html" class="sidebar-link">垃圾回收机制</a></li><li><a href="/bufan-doc/learn/javascript/13-代码风格和压缩.html" class="sidebar-link">代码风格和压缩</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>DOM和BOM</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/dom/" class="sidebar-link">DOM</a></li><li><a href="/bufan-doc/learn/bom/" class="sidebar-link">BOM</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>jQuery</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/jquery/" class="sidebar-link">jQuery</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HTML5和CSS3</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/html5-and-css3/HTML5介绍.html" class="sidebar-link">HTML5介绍</a></li><li><a href="/bufan-doc/learn/html5-and-css3/CSS3介绍.html" class="sidebar-link">CSS3 介绍</a></li><li><a href="/bufan-doc/learn/html5-and-css3/FLEX布局介绍.html" class="sidebar-link">FLEX 布局</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>移动端开发</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/mobile-web/" class="sidebar-link">移动 web</a></li><li><a href="/bufan-doc/learn/mobile-web/01-移动端适配.html" class="sidebar-link">移动端适配</a></li><li><a href="/bufan-doc/learn/mobile-web/02-移动端事件.html" class="sidebar-link">移动端事件</a></li><li><a href="/bufan-doc/learn/mobile-web/03-媒体查询.html" class="sidebar-link">媒体查询</a></li><li><a href="/bufan-doc/learn/mobile-web/04-常见移动端问题.html" class="sidebar-link">常见的移动端问题</a></li><li><a href="/bufan-doc/learn/mobile-web/05-补充.html" class="sidebar-link">扩充知识</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Node.js与AJAX</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/node-and-ajax/AJAX.html" class="active sidebar-link">AJAX</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bufan-doc/learn/node-and-ajax/AJAX.html#背景介绍" class="sidebar-link">背景介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bufan-doc/learn/node-and-ajax/AJAX.html#_1-xml-和-json" class="sidebar-link">1. xml 和 json</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/learn/node-and-ajax/AJAX.html#_2-网络请求简介" class="sidebar-link">2. 网络请求简介</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/learn/node-and-ajax/AJAX.html#_3-意义" class="sidebar-link">3. 意义</a></li></ul></li><li class="sidebar-sub-header"><a href="/bufan-doc/learn/node-and-ajax/AJAX.html#ajax-技术介绍" class="sidebar-link">AJAX 技术介绍</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bufan-doc/learn/node-and-ajax/AJAX.html#一、数据交互" class="sidebar-link">一、数据交互</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/learn/node-and-ajax/AJAX.html#二、xmlhttprequest" class="sidebar-link">二、XMLHttpRequest</a></li></ul></li></ul></li><li><a href="/bufan-doc/learn/node-and-ajax/node.html" class="sidebar-link">Node.js</a></li><li><a href="/bufan-doc/learn/node-and-ajax/Sass介绍.html" class="sidebar-link">Sass</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ES6</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/es6/" class="sidebar-link">ES6 简介</a></li><li><a href="/bufan-doc/learn/es6/01-let和const.html" class="sidebar-link">let 和 const</a></li><li><a href="/bufan-doc/learn/es6/02-箭头函数.html" class="sidebar-link">箭头函数</a></li><li><a href="/bufan-doc/learn/es6/03-函数默认值.html" class="sidebar-link">函数默认值</a></li><li><a href="/bufan-doc/learn/es6/04-模板字符串.html" class="sidebar-link">字符串模板</a></li><li><a href="/bufan-doc/learn/es6/05-解构赋值.html" class="sidebar-link">变量解构赋值</a></li><li><a href="/bufan-doc/learn/es6/06-数组的扩展.html" class="sidebar-link">数组的扩展</a></li><li><a href="/bufan-doc/learn/es6/07-Set和Map数据结构.html" class="sidebar-link">Set 和 Map 数据结构</a></li><li><a href="/bufan-doc/learn/es6/08-对象的扩展.html" class="sidebar-link">对象的扩展</a></li><li><a href="/bufan-doc/learn/es6/09-symbol.html" class="sidebar-link">Symbol</a></li><li><a href="/bufan-doc/learn/es6/10-Iterator(遍历器).html" class="sidebar-link">Iterator（遍历器）</a></li><li><a href="/bufan-doc/learn/es6/11-class.html" class="sidebar-link">class</a></li><li><a href="/bufan-doc/learn/es6/12-Promise.html" class="sidebar-link">Promise</a></li><li><a href="/bufan-doc/learn/es6/13-async、await.html" class="sidebar-link">async await</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/javascript-advance/面向对象.html" class="sidebar-link">面向对象</a></li><li><a href="/bufan-doc/learn/javascript-advance/正则表达式.html" class="sidebar-link">正则表达式</a></li><li><a href="/bufan-doc/learn/canvas/" class="sidebar-link">canvas</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/vue/" class="sidebar-link">vue 简介</a></li><li><a href="/bufan-doc/learn/vue/01-vue入门.html" class="sidebar-link">vue</a></li><li><a href="/bufan-doc/learn/vue/02-计算属性和侦听器.html" class="sidebar-link">计算属性和侦听器</a></li><li><a href="/bufan-doc/learn/vue/03-Class与Style绑定.html" class="sidebar-link">Class 与 Style 绑定</a></li><li><a href="/bufan-doc/learn/vue/04-事件处理.html" class="sidebar-link">事件处理</a></li><li><a href="/bufan-doc/learn/vue/05-组件基础.html" class="sidebar-link">组件</a></li><li><a href="/bufan-doc/learn/vue/06-生命周期.html" class="sidebar-link">生命周期</a></li><li><a href="/bufan-doc/learn/vue/07-插槽.html" class="sidebar-link">插槽</a></li><li><a href="/bufan-doc/learn/vue/08-动态组件.html" class="sidebar-link">动态组件</a></li><li><a href="/bufan-doc/learn/vue/09-处理边界情况.html" class="sidebar-link">处理边界情况</a></li><li><a href="/bufan-doc/learn/vue/10-过渡和动画.html" class="sidebar-link">过渡效果动画</a></li><li><a href="/bufan-doc/learn/vue/11-可复用性和组合.html" class="sidebar-link">Vue 的可复用性与组合</a></li><li><a href="/bufan-doc/learn/vue/12-vue-cli.html" class="sidebar-link">Vue CLI</a></li><li><a href="/bufan-doc/learn/vue/13-vue-router.html" class="sidebar-link">Vue Router</a></li><li><a href="/bufan-doc/learn/vue/14-vuex入门.html" class="sidebar-link">vuex 入门</a></li><li><a href="/bufan-doc/learn/vue/15-vuex高级.html" class="sidebar-link">vuex 进阶</a></li><li><a href="/bufan-doc/learn/vue/16-axios.html" class="sidebar-link">axios</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>微信小程序开发</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/wx-lite/" class="sidebar-link">微信小程序</a></li><li><a href="/bufan-doc/learn/wx-lite/01-小程序使用.html" class="sidebar-link">小程序的使用</a></li><li><a href="/bufan-doc/learn/wx-lite/02-小程序的生命周期.html" class="sidebar-link">生命周期</a></li><li><a href="/bufan-doc/learn/wx-lite/03-小程序事件处理.html" class="sidebar-link">小程序的事件</a></li><li><a href="/bufan-doc/learn/wx-lite/04-自定义组件.html" class="sidebar-link">自定义组件</a></li><li><a href="/bufan-doc/learn/wx-lite/05-图片操作.html" class="sidebar-link">图片操作</a></li><li><a href="/bufan-doc/learn/wx-lite/06-网络请求.html" class="sidebar-link">网络请求</a></li><li><a href="/bufan-doc/learn/wx-lite/07-微信本地存储.html" class="sidebar-link">微信本地存储</a></li><li><a href="/bufan-doc/learn/wx-lite/08-页面通信.html" class="sidebar-link">页面通讯</a></li><li><a href="/bufan-doc/learn/wx-lite/09-小程序鉴权.html" class="sidebar-link">微信获取用户信息和微信登陆</a></li><li><a href="/bufan-doc/learn/wx-lite/10-弹窗.html" class="sidebar-link">微信的弹窗</a></li><li><a href="/bufan-doc/learn/wx-lite/11-补充知识.html" class="sidebar-link">其他的小知识</a></li><li><a href="/bufan-doc/learn/wx-lite/12-注意事项.html" class="sidebar-link">注意事项</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>uni-app开发</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/uni/" class="sidebar-link">uni-app</a></li><li><a href="/bufan-doc/learn/uni/uniApp注意事项.html" class="sidebar-link">uni-app 注意事项</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>实战练习</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/learn/just-coding/" class="sidebar-link">码吧</a></li></ul></section></li></ul> </aside> <main class="page" data-v-36ae5a00> <div class="theme-default-content content__default"><h1 id="ajax"><a href="#ajax" class="header-anchor">#</a> AJAX</h1> <h2 id="背景介绍"><a href="#背景介绍" class="header-anchor">#</a> 背景介绍</h2> <p>AJAX 是 “Asynchronous JavaScript And XML”的缩写(即：异步的 JavaScript 和 XML)，是一种实现<strong>无页面刷新</strong>获取服务器数据的<strong>混合技术</strong>。<strong>它不是一种新的编程语言，而是一种用于创建更好更快以及交互性更强的 Web 应用程序的技术。</strong></p> <h3 id="_1-xml-和-json"><a href="#_1-xml-和-json" class="header-anchor">#</a> 1. xml 和 json</h3> <p><code>XML</code> 是 &quot;Extensible Markup Language&quot; 的缩写（即：可拓展标记语言），是一种特征类似 HTML，用来描述数据是什么，并承载数据的标记语言，中文的<a href="https://link.juejin.im?target=https%3A%2F%2Fzh.wikipedia.org%2Fwiki%2FXML" target="_blank" rel="noopener noreferrer">维基百科<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中有更完整的解释，我们只要知道它是一种用来承载数据的语言就足够了。</p> <p><code>JSON</code>仅仅是一种数据格式，在 JSON 发明之前，人们大量使用 <code>XML</code> 作为数据传输的载体，也正因如此，AJAX 技术的最后一个字母为“X”。而如今情况则发生了些变化，<code>JSON</code> 这种类似于字符串对象的轻量级的数据格式越来越受到开发者青睐，几乎变成了 AJAX 技术的标准数据格式，因此网传 AJAX 技术如今应该换个名字，叫做 &quot;AJAJ&quot;。</p> <h3 id="_2-网络请求简介"><a href="#_2-网络请求简介" class="header-anchor">#</a> 2. 网络请求简介</h3> <p>最初互联网的建立是为了 &quot;资源互换&quot;，但是 &quot;资源互换&quot; 的主体都是计算机 。为了方便交流，我们通常将获取资源的一端称为<strong>客户端</strong>（主要的工具是浏览器），而将派发资源的一方称为<strong>服务端</strong>（又称为“服务器”）。</p> <p>Ajax 出现之前，浏览器要从服务器请求资源，其交互模式为 “客户端发出请求 -&gt; 服务端接收请求并返回相应 HTML 文档 -&gt; 页面刷新，客户端加载新的 HTML 文档”。这种交互模式十分简洁明了，而且非常符合人的直觉，对于那时游走于互联网中的极客而言，也确实够用了。但是随着时代的进步，互联网渐渐不只是极客们的娱乐场，越来越多商业化网站的出现，使互联网不再局限于满足人们 “资源交换” 的需求，人们开始期待能够在互联网中获得更好的“<strong>使用体验</strong>”。</p> <p>试想这样一种情景，当用户点击页面中的某个按钮向服务器发送请求时，页面本质上只是一些数据发生了变化，而此时服务器却要将重绘的整个页面再返回给浏览器加载，明明只是一些数据的变化却迫使服务器要返回整个 HTML 文档，这本身会给网络带宽带来不必要的开销。而且随着用户点击不断刷新页面的交互方式很难讨人喜欢。</p> <p>在 2005 年，Google 通过其 Google Suggest 使 AJAX 变得流行起来。Google Suggest 使用 AJAX 创造出动态性极强的 web 界面：当我们在谷歌的搜索框输入关键字时，JavaScript 会把这些字符发送到服务器，然后服务器会返回一个搜索建议的列表，就像目前的百度：</p> <p><img src="https://upload-images.jianshu.io/upload_images/6784887-902ab12b813a6175.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p> <p>AJAX 技术实现了在页面数据变动时，只向服务器请求新的数据，并且在阻止页面刷新的情况下，动态的替换页面中展示的数据。从此，开发者将在“数据”层面而不是“资源”层面以更高的自由度构建网站和 Web 应用。</p> <h3 id="_3-意义"><a href="#_3-意义" class="header-anchor">#</a> 3. 意义</h3> <p>提升用户体验</p> <p>只从服务器获取需要的数据，节省带宽</p> <p>提高开发能力，开拓设计范围</p> <hr> <h2 id="ajax-技术介绍"><a href="#ajax-技术介绍" class="header-anchor">#</a> AJAX 技术介绍</h2> <h3 id="一、数据交互"><a href="#一、数据交互" class="header-anchor">#</a> 一、数据交互</h3> <p>与服务器数据交互的要点是:</p> <ol><li><p>从哪里获取数据</p> <p>我们通常使用<strong>API</strong>与各式各样的数据库交互。</p> <p>“API”是“Application Programming Interface”(即：应用程序接口)的缩写，你可以想象一些数据是开放的并且在等待被使用，而我们获取这些数据的方式便是使用 API。API 通常的形式是一个 URL，并提供指定的参数名和参数值用来定位所要获取的数据。(药方换药)</p></li> <li><p>操作数据的方式（获取/提交）</p></li></ol> <h3 id="二、xmlhttprequest"><a href="#二、xmlhttprequest" class="header-anchor">#</a> 二、XMLHttpRequest</h3> <p><strong><code>XMLHttpRequest</code>对象是 AJAX 技术的核心</strong>，它是浏览器提供的一个 API（而不是 JavaScript 原生的），用来顺畅地向服务器发送请求并解析服务器响应。</p> <ol><li><code>XMLHttpRequest</code>只是一个 JavaScript 对象，确切的说，是一个<strong>构造函数</strong>。有属性，有方法，需要通过<code>new</code>关键字进行实例化；</li> <li><code>XMLHttpRequest</code>对象是不断被扩展的。随着 XML 对象被广泛的接收，W3C 也开始着手制定相应的标准来规范其行为。目前，<code>XMLHttpRequest</code>有两个级别：1 级提供了 XML 对象的实现细节，2 级进一步发展了 XML 对象，额外添加了一些方法，属性和数据类型。但是，并不是所有浏览器都实现了 XML 对象 2 级的内容；</li></ol> <p>创建一个 XML 对象的实例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// Mozilla, Safari, IE7+ ...</span>
	httpRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>ActiveXObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// IE 6 and older</span>
	httpRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">&quot;Microsoft.XMLHTTP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>该实例的属性，方法有：</p> <ul><li><p>方法</p> <ul><li><code>.open()</code>：准备启动一个 AJAX 请求；</li> <li><code>.setRequestHeader()</code>：设置请求头部信息；</li> <li><code>.send()</code>：发送 AJAX 请求；</li> <li><code>.getResponseHeader()</code>: 获得响应头部信息；</li> <li><code>.getAllResponseHeader()</code>：获得一个包含所有头部信息的长字符串；</li> <li><code>.abort()</code>：取消请求；</li></ul></li> <li><p>属性</p> <ul><li><code>.responseText</code>：包含响应主体返回文本；</li> <li><code>.responseXML</code>：如果响应的内容类型时<code>text/xml</code>或<code>application/xml</code>，该属性将保存包含着相应数据的 XML DOM 文档；</li> <li><code>.statusText</code>：HTTP 状态的说明；</li> <li><code>.readyState</code>：表示“请求”/“响应”过程的当前活动阶段</li> <li><code>.status</code>：响应的 HTTP 状态如 200 表示成功，而 404 表示 &quot;Not Found&quot; 错误。当 <code>readyState</code> 小于 3 的时候读取这一属性会导致一个异常；</li></ul></li></ul> <ul><li><p><strong>浏览器还为该对象提供了一个<code>onreadystatechange</code>监听事件，每当 XMLHttpRequest 实例的<code>readyState</code>属性变化时，就会触发该事件的发生。</strong></p></li> <li><p><strong>某些情况下，浏览器会将多个 XMLHttpRequest 请求的结果缓存在同一个 URL。我们可以在每个 URL 的最后追加一个时间戳，这样可以确保 URL 的唯一性，从而避免获取的是浏览器缓存的结果</strong></p></li></ul> <h4 id="ajax-请求"><a href="#ajax-请求" class="header-anchor">#</a> AJAX 请求</h4> <p>与服务器交互需要注意的点</p> <ul><li>向哪里发出请求？ --即相应 API 地址；</li></ul> <ul><li>获取数据还是提交数据？ --表现为请求方式的不同：<code>GET</code> 或 <code>POST</code>；</li> <li>以何种方式等待响应？ --有“<strong>同步</strong>”和“<strong>异步</strong>”两种选择；（网络传输是一个过程，请求和响应不是同时发生的。）<strong>同步被淘汰了~~</strong></li></ul> <p>而 XMLHttpRequest 实例的<code>.open()</code>方法的作用就是用来回答以上三个问题。<code>.open()</code>方法接收三个参数：<strong>请求方式</strong>，<strong>请求 URL 地址</strong>和<strong>是否为异步请求的布尔值</strong>。</p> <p>下面是一个<code>.open()</code>方法调用的例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 该段代码会启动一个针对“example.php”的GET同步请求。</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;GET/POST&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;example.php&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="请求方式"><a href="#请求方式" class="header-anchor">#</a> 请求方式</h5> <ul><li><p><code>GET</code></p> <p>GET 请求用于<strong>获取数据</strong>，有时候我们需要获取的数据需要通过“查询参数”进行定位，在这种情况下，我们会将查询参数追加到 URL 的末尾，令服务器解析。</p> <p>查询参数是指一个由<code>?</code>号起始，由<code>&amp;</code>符号分割的包含相应<strong>键值对</strong>的字符串。用来告知浏览器所要查询的特定资源。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token string">&quot;example.php?name=tom&amp;age=24&quot;</span><span class="token punctuation">;</span> <span class="token comment">// &quot;?name=tom&amp;age=24&quot;即是一个查询参数</span>
</code></pre></div></li> <li><p><code>POST</code></p> <p>POST 请求主要用于<strong>向服务器发送应该被保存的数据</strong>，因此 POST 请求天然比 GET 请求多需要一份<strong>需要被保存的数据</strong>。那么这些数据应该放在何处呢？毕竟<code>.open()</code>方法接收的三个参数都不是需要传的参数</p> <p>这里就需要用到<code>.send()</code>方法，需要发送的数据会作为<code>.send()</code>方法的参数最终被发往服务器，该数据可以是任意大小，任意类型。注意<code>.send()</code>方法的参数一般不可为空，也就是说，对于不需要发送任何数据的 GET 请求，也需要在调用<code>.send()</code>方法时，向其传入<code>null</code>值。</p></li></ul> <h5 id="设置请求头"><a href="#设置请求头" class="header-anchor">#</a> 设置请求头</h5> <p>每个 HTTP 请求和响应都会带有相应的头部信息，包含一些与数据，收发者网络环境与状态等相关信息。XMLHttpRequest 对象提供的<code>.setRequestHeader()</code>方法为开发者提供了一个操作这两种头部信息的方法，并允许开发者自定义请求头的头部信息。</p> <p>默认情况下，当发送 AJAX 请求时，会附带以下头部信息：</p> <ul><li><code>Accept</code>：浏览器能够处理的内容类型；</li> <li><code>Accept-Charset</code>: 浏览器能够显示的字符集；</li> <li><code>Accept-Encoding</code>：浏览器能够处理的压缩编码；</li> <li><code>Accept-Language</code>：浏览器当前设置的语言；</li> <li><code>Connection</code>：浏览器与服务器之间连接的类型；</li> <li><code>Cookie</code>：当前页面设置的任何 Cookie；</li> <li><code>Host</code>：发出请求的页面所在的域；</li> <li><code>Referer</code>：发出请求的页面 URI；</li> <li><code>User-Agent</code>：浏览器的用户代理字符串；</li> <li><code>content-type</code>： 数据发送出去后，需要接收的服务端解析成功，一般服务端会根据 content-type 字段来获取参数是怎么编码的，然后对应去解码，一般认为<code>content-type</code>有以下四种类型：
<ul><li><code>text/plain</code> ajax 请求的默认值</li> <li><code>application/json</code> 目前支持率比较高的编码方式</li> <li><code>application/x-www-form-urlencoded</code> form 表单数据的提交编码设置</li> <li><code>multipart/form-data</code> 二进制文件的编码方式 ( 常用来提交图片或者文件等 )</li></ul></li></ul> <p><strong>注意：设置请求头需要在 open 方法之后，在 send 方法之前</strong></p> <hr> <p>发送 GET 请求</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 发送AJAX请求！</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;example.php&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>换个 POST 请求试试看：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 发送AJAX请求！</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;example.php&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>some_data<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a href="https://www.runoob.com/http/http-status-codes.html" target="_blank" rel="noopener noreferrer">常见的 http 状态码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>是不是感觉差点什么？因为我们只是发出了请求，还没有<strong>处理响应</strong></p> <hr> <h4 id="处理响应"><a href="#处理响应" class="header-anchor">#</a> 处理响应</h4> <p>通过为 XMLHTTPRequest 实例添加<code>onreadystatechange</code>事件处理程序。</p> <p>xhr 实例的<code>readystatechange</code>事件会监听<code>xhr.readyState</code>属性的变化，你可以将这个属性想象为一个计数器，随着 AJAX 流程的推进而不断累加，其可取的值如下：</p> <ul><li><strong>0</strong>：未初始化 -- 尚未调用<code>.open()</code>方法；</li> <li><strong>1</strong>：启动 -- 已经调用<code>.open()</code>方法，但尚未调用<code>.send()</code>方法；</li> <li><strong>2</strong>：发送 -- 已经调用<code>.send()</code>方法，但尚未接收到响应；</li> <li><strong>3</strong>：接收 -- 已经接收到部分响应数据；</li> <li><strong>4</strong>：完成 -- 已经接收到全部响应数据，而且已经可以在客户端使用了；</li></ul> <p>有了这个时间处理程序对 AJAX 进程做监听，剩下的事就简单多了，一个异步的 GET 请求代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState  <span class="token operator">==</span>  <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;example.php&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>注意</strong>：为了确保跨浏览器的兼容性，必须要在调用<code>.open()</code>方法之前指定事件处理程序，因为<code>.open()</code>方法的执行也包含在该事件处理程序的监听范围之内</p> <p>++++++++++</p> <h4 id="取消请求"><a href="#取消请求" class="header-anchor">#</a> 取消请求</h4> <p>调用<code>.abort()</code>方法。</p> <p>该方法会令 XHR 对象实例停止触发事件，并且不再允许访问任何和响应有关的对象属性。</p> <hr> <h4 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h4> <p>创建 ajax 流程</p> <ol><li>创建一个 XMLHttpRequest 对象</li> <li>为 XMLHttpRequest 对象添加 onreadystatechange 响应函数
<ul><li>判断响应是否完成 XMLHttpRequest 对象的 readyState 属性值为 4</li> <li>判断响应是否可用 XMLHttpRequest 对象的 status 属性值为 200</li> <li>打印结果 responseText</li></ul></li> <li>调用 XMLHttpRequest 对象的 open 方法（请求方式，请求地址，是否异步）</li> <li>调用 XMLHttpRequest 对象的 send 方法（不传参数使用 null）</li></ol> <p><strong>封装方法：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 封装的ajax函数
 * @param {Object} obj 接受一个对象参数,包含:
 * method 请求方式 默认GET  可传 &quot;POST&quot;
 * data 参数,默认为null
 * url 请求地址
 * success 请求成功后的回调函数,默认参数服务器返回的数据
 * fail 请求失败后的回调函数
 */</span>
<span class="token keyword">function</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	obj<span class="token punctuation">.</span>method <span class="token operator">=</span> obj<span class="token punctuation">.</span>method <span class="token operator">||</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">;</span>
	obj<span class="token punctuation">.</span>data <span class="token operator">=</span> obj<span class="token punctuation">.</span>data <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	obj<span class="token punctuation">.</span>url <span class="token operator">=</span> obj<span class="token punctuation">.</span>url <span class="token operator">||</span> <span class="token string">&quot;list&quot;</span><span class="token punctuation">;</span>
	obj<span class="token punctuation">.</span>success <span class="token operator">=</span>
		obj<span class="token punctuation">.</span>success <span class="token operator">||</span>
		<span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
		obj<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	xhr<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;sorry, can't get reponse ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span>fail<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			obj<span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>method<span class="token punctuation">,</span> <span class="token string">&quot;http://59.110.138.169/api/ajax/user/&quot;</span> <span class="token operator">+</span> obj<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">&quot;content-type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/x-www-form-urlencoded&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h4 id="补充内容"><a href="#补充内容" class="header-anchor">#</a> 补充内容</h4> <p>此内容为 XMLHttpRequest2 级规范，还没有全面普及，存在一定的兼容性问题</p> <h5 id="_1-超时设定"><a href="#_1-超时设定" class="header-anchor">#</a> 1. 超时设定</h5> <p>当我们发送一个 AJAX 请求，却迟迟得不到服务器响应，这种感觉是很糟糕的。为了缓解这种糟糕的感觉，XMLHttpRequest 2 级规范为我们提供了一个额外的属性和事件监听事件：</p> <ul><li><code>timeout</code>属性：设置超时时间，单位为毫秒；</li> <li><code>timeout</code>事件：当响应时间超出实例对象 timeout 属性时被触发；</li></ul> <p>使用方式如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 当响应时间超过1秒时，请求中止，弹出提示框</span>
xhr<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">ontimeout</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;Request did not return in a second.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>注意：当请求终止时，会调用<code>ontimeout</code>事件处理程序，此时 xhr 的<code>readyState</code>属性的值可能已变为 4，这意味着会继续调用<code>onreadystatechange</code>事件处理程序。</p> <p>浏览器兼容性：</p> <ul><li>桌面端
<ul><li>IE 10+ 与其他浏览器均支持</li></ul></li> <li>移动端
<ul><li>IE Mobile 10+ 与其他浏览器均支持</li></ul></li></ul> <h5 id="_2-进度事件"><a href="#_2-进度事件" class="header-anchor">#</a> 2. 进度事件</h5> <p>Progress Events 规范是 W3C 制定的一个工作草案。该规范定义了与客户端与服务器通信相关的一系列事件，这些事件监听了通信进程中的各个关键节点，使我们能够以更细的颗粒度掌控数据传输过程中的细节。目前共有 6 个进度事件，他们会随数据传输进展被顺序触发（除了 error，abort 事件），让我们看看他们的定义和浏览器兼容情况：</p> <ul><li><code>loadstart</code>：在接收到响应数据的第一个字节时触发；
<ul><li>桌面端：除 Safari Mobile 未知外，其他浏览器均支持</li> <li>移动端：除 Safari Mobile 未知外，其他浏览器均支持</li></ul></li> <li><code>progress</code>：在接收响应期间持续不断地触发；
<ul><li>该事件可以实现加载进度条效果。因为<code>onprogress</code>事件处理程序会接收到一个<code>event</code>对象，其<code>target</code>属性为 XHR 对象实例，但却额外包含着三个属性：
<ul><li><code>lengthComputable</code>：表示进度信息是否可用的布尔值</li> <li><code>loaded</code>：表示目前接收的字节数</li> <li><code>total</code>：表示根据 Content-Length 响应头部确定的预期字节数</li></ul></li> <li>桌面端：IE10+ 与其他浏览器均支持</li> <li>移动端：均支持</li></ul></li> <li><code>error</code>：在请求发生错误时触发；
<ul><li>桌面端：所有浏览器均支持（<a href="https://link.juejin.im?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FErrorEvent" target="_blank" rel="noopener noreferrer">信息来源<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>）</li> <li>移动端：除 IE Mobile 不支持外，其他浏览器均支持（<a href="https://link.juejin.im?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FErrorEvent" target="_blank" rel="noopener noreferrer">信息来源<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>）</li></ul></li> <li><code>abort</code>：在调用<code>abort()</code>方法时触发；
<ul><li>桌面端：未知</li> <li>移动端：未知</li></ul></li> <li><code>load</code>：在接收到完整的响应数据时触发；
<ul><li>该事件帮助我们节省了<code>readstatechange</code>事件，我们不必在 XHR 对象实例上绑定该事件监听函数以追踪实例上<code>readState</code>属性的变化</li> <li>桌面端：IE7+ 与其他浏览器均支持</li> <li>移动端：Chrome for Android，Edge，Firefox Mobile 支持，其余浏览器未知</li></ul></li> <li><code>loadend</code>：在通信完成或者触发<code>error</code>，<code>abort</code>，或<code>load</code>事件后触发；
<ul><li>桌面端：所有浏览器不支持</li> <li>移动端：所有浏览器不支持</li></ul></li></ul> <p>以下方法可查看所有事件：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>controls<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>xhr success<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>xhr<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Click to start XHR (success)<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>xhr error<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>xhr<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Click to start XHR (error)<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>xhr abort<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>xhr<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Click to start XHR (abort)<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">readonly</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>event-log<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> xhrButtonSuccess <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.xhr.success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> xhrButtonError <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.xhr.error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> xhrButtonAbort <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.xhr.abort&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> log <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.event-log&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">handleEvent</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	log<span class="token punctuation">.</span>textContent <span class="token operator">=</span> log<span class="token punctuation">.</span>textContent <span class="token operator">+</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token punctuation">.</span>loaded<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> bytes transferred\n</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">addListeners</span><span class="token punctuation">(</span><span class="token parameter">xhr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;loadstart&quot;</span><span class="token punctuation">,</span> handleEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>
	xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;load&quot;</span><span class="token punctuation">,</span> handleEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>
	xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;loadend&quot;</span><span class="token punctuation">,</span> handleEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>
	xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;progress&quot;</span><span class="token punctuation">,</span> handleEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>
	xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> handleEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>
	xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;abort&quot;</span><span class="token punctuation">,</span> handleEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">runXHR</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	log<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

	<span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">addListeners</span><span class="token punctuation">(</span>xhr<span class="token punctuation">)</span><span class="token punctuation">;</span>
	xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
	xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> xhr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

xhrButtonSuccess<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">runXHR</span><span class="token punctuation">(</span><span class="token string">&quot;https://mdn.mozillademos.org/files/16553/DgsZYJNXcAIPwzy.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

xhrButtonError<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">runXHR</span><span class="token punctuation">(</span><span class="token string">&quot;https://somewhere.org/i-dont-exist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

xhrButtonAbort<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">runXHR</span><span class="token punctuation">(</span><span class="token string">&quot;https://mdn.mozillademos.org/files/16553/DgsZYJNXcAIPwzy.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>注意：需要在<code>.open()</code>方法前调用<code>onprogress</code>事件处理程序</strong></p> <h5 id="豆瓣图片处理"><a href="#豆瓣图片处理" class="header-anchor">#</a> 豆瓣图片处理</h5> <p>豆瓣 api 图片在本地页面上无法显示，但是单独打开链接却显示，原因是 请求 403，网传是因为豆瓣防盗链</p> <p>解决办法，在页面上加入： <code>&lt;meta name=&quot;referrer&quot; content=&quot;never&quot;&gt;</code></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">10/9/2019, 2:56:35 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/bufan-doc/learn/mobile-web/05-补充.html" class="prev">
          扩充知识
        </a></span> <span class="next"><a href="/bufan-doc/learn/node-and-ajax/node.html">
          Node.js
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/bufan-doc/assets/js/app.f4cc6427.js" defer></script><script src="/bufan-doc/assets/js/4.d60abc91.js" defer></script><script src="/bufan-doc/assets/js/3.08e48031.js" defer></script><script src="/bufan-doc/assets/js/88.23a39bc5.js" defer></script><script src="/bufan-doc/assets/js/14.618a24b7.js" defer></script>
  </body>
</html>
