<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue 常考基础知识点 | 不凡学院前端100天</title>
    <meta name="description" content="快速上手,循序渐进">
    <link rel="icon" href="/bufan-doc/logo.jpg">
  <link rel="manifest" href="/bufan-doc/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/bufan-doc/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/bufan-doc/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/bufan-doc/assets/css/0.styles.4fc22246.css" as="style"><link rel="preload" href="/bufan-doc/assets/js/app.f4cc6427.js" as="script"><link rel="preload" href="/bufan-doc/assets/js/4.d60abc91.js" as="script"><link rel="preload" href="/bufan-doc/assets/js/3.08e48031.js" as="script"><link rel="preload" href="/bufan-doc/assets/js/44.4675ab38.js" as="script"><link rel="preload" href="/bufan-doc/assets/js/14.618a24b7.js" as="script"><link rel="prefetch" href="/bufan-doc/assets/js/10.3b8a5562.js"><link rel="prefetch" href="/bufan-doc/assets/js/100.4ba68262.js"><link rel="prefetch" href="/bufan-doc/assets/js/101.6db92bf8.js"><link rel="prefetch" href="/bufan-doc/assets/js/102.01d55fe2.js"><link rel="prefetch" href="/bufan-doc/assets/js/103.4104b1e2.js"><link rel="prefetch" href="/bufan-doc/assets/js/104.af35539f.js"><link rel="prefetch" href="/bufan-doc/assets/js/105.64f144d2.js"><link rel="prefetch" href="/bufan-doc/assets/js/106.1ad49cc0.js"><link rel="prefetch" href="/bufan-doc/assets/js/107.b3243d38.js"><link rel="prefetch" href="/bufan-doc/assets/js/108.e4f06cdf.js"><link rel="prefetch" href="/bufan-doc/assets/js/109.f82c6f4f.js"><link rel="prefetch" href="/bufan-doc/assets/js/11.dabd9edf.js"><link rel="prefetch" href="/bufan-doc/assets/js/110.43ef8a19.js"><link rel="prefetch" href="/bufan-doc/assets/js/111.8d21dabd.js"><link rel="prefetch" href="/bufan-doc/assets/js/112.97d55372.js"><link rel="prefetch" href="/bufan-doc/assets/js/113.17be5afc.js"><link rel="prefetch" href="/bufan-doc/assets/js/114.7c7c0031.js"><link rel="prefetch" href="/bufan-doc/assets/js/115.6191c96c.js"><link rel="prefetch" href="/bufan-doc/assets/js/116.f8406fce.js"><link rel="prefetch" href="/bufan-doc/assets/js/117.7e6ced5f.js"><link rel="prefetch" href="/bufan-doc/assets/js/118.95f2b2c6.js"><link rel="prefetch" href="/bufan-doc/assets/js/119.656fb4a6.js"><link rel="prefetch" href="/bufan-doc/assets/js/12.28f15829.js"><link rel="prefetch" href="/bufan-doc/assets/js/120.884f6058.js"><link rel="prefetch" href="/bufan-doc/assets/js/121.1ea98fcd.js"><link rel="prefetch" href="/bufan-doc/assets/js/122.ff3c9d25.js"><link rel="prefetch" href="/bufan-doc/assets/js/123.2d0a0879.js"><link rel="prefetch" href="/bufan-doc/assets/js/124.dbee8ca1.js"><link rel="prefetch" href="/bufan-doc/assets/js/125.fe02abe6.js"><link rel="prefetch" href="/bufan-doc/assets/js/126.ea7f7bb5.js"><link rel="prefetch" href="/bufan-doc/assets/js/127.606c2de1.js"><link rel="prefetch" href="/bufan-doc/assets/js/128.0f2b467b.js"><link rel="prefetch" href="/bufan-doc/assets/js/129.97cbaeca.js"><link rel="prefetch" href="/bufan-doc/assets/js/13.83be0207.js"><link rel="prefetch" href="/bufan-doc/assets/js/15.671b0072.js"><link rel="prefetch" href="/bufan-doc/assets/js/16.6425c53e.js"><link rel="prefetch" href="/bufan-doc/assets/js/17.f748524f.js"><link rel="prefetch" href="/bufan-doc/assets/js/18.dae45be7.js"><link rel="prefetch" href="/bufan-doc/assets/js/19.a61fe4f0.js"><link rel="prefetch" href="/bufan-doc/assets/js/20.80399a10.js"><link rel="prefetch" href="/bufan-doc/assets/js/21.d424c18b.js"><link rel="prefetch" href="/bufan-doc/assets/js/22.5d82a21d.js"><link rel="prefetch" href="/bufan-doc/assets/js/23.36b6d0a0.js"><link rel="prefetch" href="/bufan-doc/assets/js/24.b2436ce4.js"><link rel="prefetch" href="/bufan-doc/assets/js/25.d0c6e25f.js"><link rel="prefetch" href="/bufan-doc/assets/js/26.b5e3c19c.js"><link rel="prefetch" href="/bufan-doc/assets/js/27.a524df1a.js"><link rel="prefetch" href="/bufan-doc/assets/js/28.25c0ed5e.js"><link rel="prefetch" href="/bufan-doc/assets/js/29.f9b5a855.js"><link rel="prefetch" href="/bufan-doc/assets/js/30.67d39ab6.js"><link rel="prefetch" href="/bufan-doc/assets/js/31.92b1b15d.js"><link rel="prefetch" href="/bufan-doc/assets/js/32.f4e82e10.js"><link rel="prefetch" href="/bufan-doc/assets/js/33.8e078611.js"><link rel="prefetch" href="/bufan-doc/assets/js/34.b4bea20d.js"><link rel="prefetch" href="/bufan-doc/assets/js/35.24d90a48.js"><link rel="prefetch" href="/bufan-doc/assets/js/36.ef702182.js"><link rel="prefetch" href="/bufan-doc/assets/js/37.f5cc6f4f.js"><link rel="prefetch" href="/bufan-doc/assets/js/38.45b62383.js"><link rel="prefetch" href="/bufan-doc/assets/js/39.5351a017.js"><link rel="prefetch" href="/bufan-doc/assets/js/40.39da4318.js"><link rel="prefetch" href="/bufan-doc/assets/js/41.bc5678de.js"><link rel="prefetch" href="/bufan-doc/assets/js/42.f4a5cc7c.js"><link rel="prefetch" href="/bufan-doc/assets/js/43.83e2ec23.js"><link rel="prefetch" href="/bufan-doc/assets/js/45.72d3f200.js"><link rel="prefetch" href="/bufan-doc/assets/js/46.8d77ad14.js"><link rel="prefetch" href="/bufan-doc/assets/js/47.7daeae21.js"><link rel="prefetch" href="/bufan-doc/assets/js/48.8c3532fd.js"><link rel="prefetch" href="/bufan-doc/assets/js/49.d2ceb345.js"><link rel="prefetch" href="/bufan-doc/assets/js/5.38bfdf08.js"><link rel="prefetch" href="/bufan-doc/assets/js/50.41300c4a.js"><link rel="prefetch" href="/bufan-doc/assets/js/51.7123e828.js"><link rel="prefetch" href="/bufan-doc/assets/js/52.96ab2ac5.js"><link rel="prefetch" href="/bufan-doc/assets/js/53.01bcfe44.js"><link rel="prefetch" href="/bufan-doc/assets/js/54.379a6e11.js"><link rel="prefetch" href="/bufan-doc/assets/js/55.05379669.js"><link rel="prefetch" href="/bufan-doc/assets/js/56.380aaeac.js"><link rel="prefetch" href="/bufan-doc/assets/js/57.5638cfe7.js"><link rel="prefetch" href="/bufan-doc/assets/js/58.4aaf9b06.js"><link rel="prefetch" href="/bufan-doc/assets/js/59.6db0022e.js"><link rel="prefetch" href="/bufan-doc/assets/js/6.2c430a05.js"><link rel="prefetch" href="/bufan-doc/assets/js/60.5b1ba8d4.js"><link rel="prefetch" href="/bufan-doc/assets/js/61.f226504c.js"><link rel="prefetch" href="/bufan-doc/assets/js/62.2563abf3.js"><link rel="prefetch" href="/bufan-doc/assets/js/63.94b44c4a.js"><link rel="prefetch" href="/bufan-doc/assets/js/64.2b0b61cf.js"><link rel="prefetch" href="/bufan-doc/assets/js/65.6d2830f1.js"><link rel="prefetch" href="/bufan-doc/assets/js/66.65a4cc01.js"><link rel="prefetch" href="/bufan-doc/assets/js/67.7b270307.js"><link rel="prefetch" href="/bufan-doc/assets/js/68.a8fe45f4.js"><link rel="prefetch" href="/bufan-doc/assets/js/69.8f88d229.js"><link rel="prefetch" href="/bufan-doc/assets/js/7.e6ecd274.js"><link rel="prefetch" href="/bufan-doc/assets/js/70.1ddc66b4.js"><link rel="prefetch" href="/bufan-doc/assets/js/71.77170c41.js"><link rel="prefetch" href="/bufan-doc/assets/js/72.1dc4049b.js"><link rel="prefetch" href="/bufan-doc/assets/js/73.7da3757c.js"><link rel="prefetch" href="/bufan-doc/assets/js/74.2181d25c.js"><link rel="prefetch" href="/bufan-doc/assets/js/75.be8d5dc6.js"><link rel="prefetch" href="/bufan-doc/assets/js/76.4cbdb224.js"><link rel="prefetch" href="/bufan-doc/assets/js/77.5ee263b6.js"><link rel="prefetch" href="/bufan-doc/assets/js/78.6b078925.js"><link rel="prefetch" href="/bufan-doc/assets/js/79.414db56b.js"><link rel="prefetch" href="/bufan-doc/assets/js/8.156e0c5d.js"><link rel="prefetch" href="/bufan-doc/assets/js/80.213572d0.js"><link rel="prefetch" href="/bufan-doc/assets/js/81.33f5de66.js"><link rel="prefetch" href="/bufan-doc/assets/js/82.d854fa6f.js"><link rel="prefetch" href="/bufan-doc/assets/js/83.110c252e.js"><link rel="prefetch" href="/bufan-doc/assets/js/84.473df94b.js"><link rel="prefetch" href="/bufan-doc/assets/js/85.ee0c2c9c.js"><link rel="prefetch" href="/bufan-doc/assets/js/86.ec58ee6e.js"><link rel="prefetch" href="/bufan-doc/assets/js/87.82972f59.js"><link rel="prefetch" href="/bufan-doc/assets/js/88.23a39bc5.js"><link rel="prefetch" href="/bufan-doc/assets/js/89.4be8b33a.js"><link rel="prefetch" href="/bufan-doc/assets/js/9.44c09d8c.js"><link rel="prefetch" href="/bufan-doc/assets/js/90.44c2861c.js"><link rel="prefetch" href="/bufan-doc/assets/js/91.468becad.js"><link rel="prefetch" href="/bufan-doc/assets/js/92.9e5ceb34.js"><link rel="prefetch" href="/bufan-doc/assets/js/93.9032fb68.js"><link rel="prefetch" href="/bufan-doc/assets/js/94.d7e6c360.js"><link rel="prefetch" href="/bufan-doc/assets/js/95.0fa635fb.js"><link rel="prefetch" href="/bufan-doc/assets/js/96.c7a82be8.js"><link rel="prefetch" href="/bufan-doc/assets/js/97.bf5ce894.js"><link rel="prefetch" href="/bufan-doc/assets/js/98.9d46ee61.js"><link rel="prefetch" href="/bufan-doc/assets/js/99.40ccc798.js"><link rel="prefetch" href="/bufan-doc/assets/js/vendors~notification.8531c786.js">
    <link rel="stylesheet" href="/bufan-doc/assets/css/0.styles.4fc22246.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-36ae5a00><header class="navbar" data-v-36ae5a00><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/bufan-doc/" class="home-link router-link-active"><!----> <span class="site-name">不凡学院前端100天</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/bufan-doc/learn/" class="nav-link">学习教程</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">配套资料</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bufan-doc/learn/soft/" class="nav-link">前端工具</a></li><li class="dropdown-item"><!----> <a href="/bufan-doc/interview/" class="nav-link router-link-active">面试之道</a></li></ul></div></div><div class="nav-item"><a href="http://www.bufanui.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  不凡官网
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/nevermo2013/dingpq" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask" data-v-36ae5a00></div> <aside class="sidebar" data-v-36ae5a00><nav class="nav-links"><div class="nav-item"><a href="/bufan-doc/learn/" class="nav-link">学习教程</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">配套资料</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/bufan-doc/learn/soft/" class="nav-link">前端工具</a></li><li class="dropdown-item"><!----> <a href="/bufan-doc/interview/" class="nav-link router-link-active">面试之道</a></li></ul></div></div><div class="nav-item"><a href="http://www.bufanui.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  不凡官网
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/nevermo2013/dingpq" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <a href="http://www.bufanui.com" target="_blank" class="ads ads-top" data-v-36ae5a00><img src="/bufan-doc/assets/img/bf.b6eae9c3.jpg" alt="" class="ads-img" data-v-36ae5a00></a> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HTML+CSS基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/interview/" class="sidebar-link">常考面试题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JS基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/interview/js/js基础.html" class="sidebar-link">JS 基础考点</a></li><li><a href="/bufan-doc/interview/js/ES6.html" class="sidebar-link">ES6 知识点</a></li><li><a href="/bufan-doc/interview/js/原型与继承.html" class="sidebar-link">原型与继承</a></li><li><a href="/bufan-doc/interview/js/异步编程与EventLoop.html" class="sidebar-link">异步编程 与 EventLoop</a></li><li><a href="/bufan-doc/interview/js/WebAPI.html" class="sidebar-link">JS-Web-API</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>浏览器与网络协议</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/interview/chrome/浏览器相关基础.html" class="sidebar-link">浏览器相关基础</a></li><li><a href="/bufan-doc/interview/chrome/web安全.html" class="sidebar-link">Web 安全</a></li><li><a href="/bufan-doc/interview/chrome/网络协议.html" class="sidebar-link">HTTP</a></li><li><a href="/bufan-doc/interview/chrome/跨域.html" class="sidebar-link">跨域</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Vue基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/interview/vue/Vue常考知识点.html" class="active sidebar-link">Vue 常考基础知识点</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#生命周期钩子函数" class="sidebar-link">生命周期钩子函数</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#组件通信" class="sidebar-link">组件通信</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#父子通信" class="sidebar-link">父子通信</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#兄弟组件通信" class="sidebar-link">兄弟组件通信</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#跨多层次组件通信" class="sidebar-link">跨多层次组件通信</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#任意组件" class="sidebar-link">任意组件</a></li></ul></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#extend-能做什么" class="sidebar-link">extend 能做什么</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#mixin-和-mixins-区别" class="sidebar-link">mixin 和 mixins 区别</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#computed-和-watch-区别" class="sidebar-link">computed 和 watch 区别</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#keep-alive-组件有什么作用" class="sidebar-link">keep-alive 组件有什么作用</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#v-show-与-v-if-区别" class="sidebar-link">v-show 与 v-if 区别</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#组件中-data-什么时候可以使用对象" class="sidebar-link">组件中 data 什么时候可以使用对象</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#响应式原理" class="sidebar-link">响应式原理</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#object-defineproperty-的缺陷" class="sidebar-link">Object.defineProperty 的缺陷</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#编译过程" class="sidebar-link">编译过程</a></li><li class="sidebar-sub-header"><a href="/bufan-doc/interview/vue/Vue常考知识点.html#nexttick-原理分析" class="sidebar-link">NextTick 原理分析</a></li></ul></li><li><a href="/bufan-doc/interview/vue/项目问题及解决方法.html" class="sidebar-link">Vue 项目常见问题及解决方法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>性能优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/interview/performance/" class="sidebar-link">前端性能优化</a></li><li><a href="/bufan-doc/interview/performance/提升加载速度.html" class="sidebar-link">减少页面体积，提升网络加载</a></li><li><a href="/bufan-doc/interview/performance/提升页面渲染.html" class="sidebar-link">优化页面渲染</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>设计模式与算法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/interview/design/设计模式.html" class="sidebar-link">设计模式</a></li><li><a href="/bufan-doc/interview/design/常见算法.html" class="sidebar-link">数据结构与算法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>开发工具与环境</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bufan-doc/interview/dev-env/" class="sidebar-link">开发环境相关知识点</a></li></ul></section></li></ul> </aside> <main class="page" data-v-36ae5a00> <div class="theme-default-content content__default"><h1 id="vue-常考基础知识点"><a href="#vue-常考基础知识点" class="header-anchor">#</a> Vue 常考基础知识点</h1> <p>学习 Vue 的一些经常考到的基础知识点。</p> <h2 id="生命周期钩子函数"><a href="#生命周期钩子函数" class="header-anchor">#</a> 生命周期钩子函数</h2> <p>在 beforeCreate 钩子函数调用的时候，是获取不到 props 或者 data 中的数据的，因为这些数据的初始化都在 initState 中。</p> <p>然后会执行 created 钩子函数，在这一步的时候已经可以访问到之前不能访问到的数据，但是这时候组件还没被挂载，所以是看不到的。</p> <p>接下来会先执行 beforeMount 钩子函数，开始创建 VDOM，最后执行 mounted 钩子，并将 VDOM 渲染为真实 DOM 并且渲染数据。组件中如果有子组件的话，会递归挂载子组件，只有当所有子组件全部挂载完毕，才会执行根组件的挂载钩子。</p> <p>接下来是数据更新时会调用的钩子函数 beforeUpdate 和 updated，这两个钩子函数没什么好说的，就是分别在数据更新前和更新后会调用。</p> <p>另外还有 keep-alive 独有的生命周期，分别为 activated 和 deactivated 。用 keep-alive 包裹的组件在切换时不会进行销毁，而是缓存到内存中并执行 deactivated 钩子函数，命中缓存渲染后会执行 actived 钩子函数。</p> <p>最后就是销毁组件的钩子函数 beforeDestroy 和 destroyed。前者适合移除事件、定时器等等，否则可能会引起内存泄露的问题。然后进行一系列的销毁操作，如果有子组件的话，也会递归销毁子组件，所有子组件都销毁完毕后才会执行根组件的 destroyed 钩子函数。</p> <h2 id="组件通信"><a href="#组件通信" class="header-anchor">#</a> 组件通信</h2> <p>组件通信一般分为以下几种情况：</p> <ul><li>父子组件通信</li> <li>兄弟组件通信</li> <li>跨多层级组件通信</li> <li>任意组件
对于以上每种情况都有多种方式去实现，接下来就来学习下如何实现。</li></ul> <h3 id="父子通信"><a href="#父子通信" class="header-anchor">#</a> 父子通信</h3> <p>父组件通过 props 传递数据给子组件，子组件通过 emit 发送事件传递数据给父组件，这两种方式是最常用的父子通信实现办法。</p> <p>这种父子通信方式也就是典型的单向数据流，父组件通过 props 传递数据，子组件不能直接修改 props， 而是必须通过发送事件的方式告知父组件修改数据。</p> <p>另外这两种方式还可以使用语法糖 v-model 来直接实现，因为 v-model 默认会解析成名为 value 的 prop 和名为 input 的事件。这种语法糖的方式是典型的双向绑定，常用于 UI 控件上，但是究其根本，还是通过事件的方法让父组件修改数据。</p> <p>当然我们还可以通过访问 $parent 或者 $children 对象来访问组件实例中的方法和数据。</p> <p>另外如果你使用 Vue 2.3 及以上版本的话还可以使用 $listeners 和 .sync 这两个属性。</p> <p>$listeners 属性会将父组件中的 (不含 .native 修饰器的) v-on 事件监听器传递给子组件，子组件可以通过访问 $listeners 来自定义监听器。</p> <p>.sync 属性是个语法糖，可以很简单的实现子组件与父组件通信</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!--父组件中--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">:value.sync</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>value<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token comment">&lt;!--以上写法等同于--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>value<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">@update:</span>value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>v =&gt; value = v<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>comp</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--子组件中--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'update:value'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="兄弟组件通信"><a href="#兄弟组件通信" class="header-anchor">#</a> 兄弟组件通信</h3> <p>对于这种情况可以通过查找父组件中的子组件实现，也就是 this.$parent.$children，在 $children 中可以通过组件 name 查询到需要的组件实例，然后进行通信。</p> <h3 id="跨多层次组件通信"><a href="#跨多层次组件通信" class="header-anchor">#</a> 跨多层次组件通信</h3> <p>对于这种情况可以使用 Vue 2.2 新增的 API provide / inject，虽然文档中不推荐直接使用在业务中，但是如果用得好的话还是很有用的。</p> <p>假设有父组件 A，然后有一个跨多层级的子组件 B</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 父组件 A</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	provide<span class="token punctuation">:</span> <span class="token punctuation">{</span>
		data<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 子组件 B</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	inject<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 无论跨几层都能获得父组件的 data 属性</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; 1</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="任意组件"><a href="#任意组件" class="header-anchor">#</a> 任意组件</h3> <p>这种方式可以通过 Vuex 或者 Event Bus 解决，另外如果你不怕麻烦的话，可以使用这种方式解决上述所有的通信情况</p> <h2 id="extend-能做什么"><a href="#extend-能做什么" class="header-anchor">#</a> extend 能做什么</h2> <p>这个 API 很少用到，作用是扩展组件生成一个构造器，通常会与 $mount 一起使用。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 创建组件构造器</span>
<span class="token keyword">let</span> Component <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	template<span class="token punctuation">:</span> <span class="token string">&quot;&lt;div&gt;test&lt;/div&gt;&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 挂载到 #app 上</span>
<span class="token keyword">new</span> <span class="token class-name">Component</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 除了上面的方式，还可以用来扩展已有的组件</span>
<span class="token keyword">let</span> SuperComponent <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">SuperComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">SuperComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="mixin-和-mixins-区别"><a href="#mixin-和-mixins-区别" class="header-anchor">#</a> mixin 和 mixins 区别</h2> <p>mixin 用于全局混入，会影响到每个组件实例，通常插件都是这样做初始化的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Vue<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token function">beforeCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// ...逻辑</span>
		<span class="token comment">// 这种方式会影响到每个组件的 beforeCreate 钩子函数</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>虽然文档不建议我们在应用中直接使用 mixin，但是如果不滥用的话也是很有帮助的，比如可以全局混入封装好的 ajax 或者一些工具函数等等。</p> <p>mixins 应该是我们最常使用的扩展组件的方式了。如果多个组件中有相同的业务逻辑，就可以将这些逻辑剥离出来，通过 mixins 混入代码，比如上拉下拉加载数据这种逻辑等等。</p> <p>另外需要注意的是 mixins 混入的钩子函数会先于组件内的钩子函数执行，并且在遇到同名选项的时候也会有选择性的进行合并，具体可以阅读 文档。</p> <h2 id="computed-和-watch-区别"><a href="#computed-和-watch-区别" class="header-anchor">#</a> computed 和 watch 区别</h2> <p>computed 是计算属性，依赖其他属性计算值，并且 computed 的值有缓存，只有当计算值变化才会返回内容。</p> <p>watch 监听到值的变化就会执行回调，在回调中可以进行一些逻辑操作。</p> <p>所以一般来说需要依赖别的属性来动态获得值的时候可以使用 computed，对于监听到值的变化需要做一些复杂业务逻辑的情况可以使用 watch。</p> <p>另外 computed 和 watch 还都支持对象的写法，这种方式知道的人并不多。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>vm<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token string">&quot;obj&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
	<span class="token comment">// 深度遍历</span>
	deep<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
	<span class="token comment">// 立即触发</span>
	immediate<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
	<span class="token comment">// 执行的函数</span>
	<span class="token function-variable function">handler</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	data<span class="token punctuation">:</span> <span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
	computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
		aPlus<span class="token punctuation">:</span> <span class="token punctuation">{</span>
			<span class="token comment">// this.aPlus 时触发</span>
			<span class="token function-variable function">get</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">// this.aPlus = 1 时触发</span>
			<span class="token function-variable function">set</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> v <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="keep-alive-组件有什么作用"><a href="#keep-alive-组件有什么作用" class="header-anchor">#</a> keep-alive 组件有什么作用</h2> <p>如果你需要在组件切换的时候，保存一些组件的状态防止多次渲染，就可以使用 keep-alive 组件包裹需要保存的组件。</p> <p>对于 keep-alive 组件来说，它拥有两个独有的生命周期钩子函数，分别为 activated 和 deactivated 。用 keep-alive 包裹的组件在切换时不会进行销毁，而是缓存到内存中并执行 deactivated 钩子函数，命中缓存渲染后会执行 actived 钩子函数。</p> <h2 id="v-show-与-v-if-区别"><a href="#v-show-与-v-if-区别" class="header-anchor">#</a> v-show 与 v-if 区别</h2> <p>v-show 只是在 display: none 和 display: block 之间切换。无论初始条件是什么都会被渲染出来，后面只需要切换 CSS，DOM 还是一直保留着的。所以总的来说 v-show 在初始渲染时有更高的开销，但是切换开销很小，更适合于频繁切换的场景。</p> <p>v-if 的话就得说到 Vue 底层的编译了。当属性初始为 false 时，组件就不会被渲染，直到条件为 true，并且切换条件时会触发销毁/挂载组件，所以总的来说在切换时开销更高，更适合不经常切换的场景。</p> <p>并且基于 v-if 的这种惰性渲染机制，可以在必要的时候才去渲染组件，减少整个页面的初始渲染开销。</p> <h2 id="组件中-data-什么时候可以使用对象"><a href="#组件中-data-什么时候可以使用对象" class="header-anchor">#</a> 组件中 data 什么时候可以使用对象</h2> <p>这道题目其实更多考的是 JS 功底。</p> <p>组件复用时所有组件实例都会共享 data，如果 data 是对象的话，就会造成一个组件修改 data 以后会影响到其他所有组件，所以需要将 data 写成函数，每次用到就调用一次函数获得新的数据。</p> <p>当我们使用 new Vue() 的方式的时候，无论我们将 data 设置为对象还是函数都是可以的，因为 new Vue() 的方式是生成一个根组件，该组件不会复用，也就不存在共享 data 的情况了。</p> <h2 id="响应式原理"><a href="#响应式原理" class="header-anchor">#</a> 响应式原理</h2> <p>Vue 内部使用了 Object.defineProperty() 来实现数据响应式，通过这个函数可以监听到 set 和 get 的事件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">&quot;yck&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">observe</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> name <span class="token operator">=</span> data<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// -&gt; get value</span>
data<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;yyy&quot;</span><span class="token punctuation">;</span> <span class="token comment">// -&gt; change value</span>

<span class="token keyword">function</span> <span class="token function">observe</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 判断类型</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj <span class="token operator">||</span> <span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token function">defineReactive</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 递归子属性</span>
	<span class="token function">observe</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
	Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
		<span class="token comment">// 可枚举</span>
		enumerable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		<span class="token comment">// 可配置</span>
		configurable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		<span class="token comment">// 自定义函数</span>
		<span class="token function-variable function">get</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token function">reactiveGetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;get value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> val<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function-variable function">set</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token function">reactiveSetter</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;change value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			val <span class="token operator">=</span> newVal<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>以上代码简单的实现了如何监听数据的 set 和 get 的事件，但是仅仅如此是不够的，因为自定义的函数一开始是不会执行的。只有先执行了依赖收集，才能在属性更新的时候派发更新，所以接下来我们需要先触发依赖收集。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
	{{name}}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>在解析如上模板代码时，遇到  就会进行依赖收集。</p> <p>接下来我们先来实现一个 Dep 类，用于解耦属性的依赖收集和派发更新操作。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 通过 Dep 解耦属性的依赖和更新操作</span>
<span class="token keyword">class</span> <span class="token class-name">Dep</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>subs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 添加依赖</span>
	<span class="token function">addSub</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 更新</span>
	<span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			sub<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 全局属性，通过该属性配置 Watcher</span>
Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre></div><p>以上的代码实现很简单，当需要依赖收集的时候调用 addSub，当需要派发更新的时候调用 notify。</p> <p>接下来我们先来简单的了解下 Vue 组件挂载时添加响应式的过程。在组件挂载时，会先对所有需要的属性调用 Object.defineProperty()，然后实例化 Watcher，传入组件更新的回调。在实例化过程中，会对模板中的属性进行求值，触发依赖收集。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Watcher</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 将 Dep.target 指向自己</span>
		<span class="token comment">// 然后触发属性的 getter 添加监听</span>
		<span class="token comment">// 最后将 Dep.target 置空</span>
		Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>cb <span class="token operator">=</span> cb<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>obj <span class="token operator">=</span> obj<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
		Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 获得新值</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>obj<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token comment">// 调用 update 方法更新 Dom</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>以上就是 Watcher 的简单实现，在执行构造函数的时候将 Dep.target 指向自身，从而使得收集到了对应的 Watcher，在派发更新的时候取出对应的 Watcher 然后执行 update 函数。</p> <p>接下来，需要对 defineReactive 函数进行改造，在自定义函数中添加依赖收集和派发更新相关的代码。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 递归子属性</span>
	<span class="token function">observe</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">let</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
		enumerable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		configurable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		<span class="token function-variable function">get</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token function">reactiveGetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;get value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// 将 Watcher 添加到订阅</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				dp<span class="token punctuation">.</span><span class="token function">addSub</span><span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> val<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function-variable function">set</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token function">reactiveSetter</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;change value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			val <span class="token operator">=</span> newVal<span class="token punctuation">;</span>
			<span class="token comment">// 执行 watcher 的 update 方法</span>
			dp<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>以上所有代码实现了一个简易的数据响应式，核心思路就是手动触发一次属性的 getter 来实现依赖收集。</p> <p>现在我们就来测试下代码的效果，只需要把所有的代码复制到浏览器中执行，就会发现页面的内容全部被替换了。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">&quot;yck&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">observe</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerText <span class="token operator">=</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 模拟解析到 `{{name}}` 触发的操作</span>
<span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// update Dom innerText</span>
data<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;yyy&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="object-defineproperty-的缺陷"><a href="#object-defineproperty-的缺陷" class="header-anchor">#</a> Object.defineProperty 的缺陷</h2> <p>以上已经分析完了 Vue 的响应式原理，接下来说一点 Object.defineProperty 中的缺陷。</p> <p>如果通过下标方式<code>修改数组数据</code>或者给<code>对象新增属性</code>并不会触发组件的重新渲染，因为 Object.defineProperty 不能拦截到这些操作，更精确的来说，对于数组而言，大部分操作都是拦截不到的，只是 Vue 内部通过重写函数的方式解决了这个问题。</p> <p>对于数组而言，Vue 内部重写了以下函数实现派发更新</p> <ul><li><code>push</code>,</li> <li><code>pop</code>,</li> <li><code>shift</code>,</li> <li><code>unshift</code>,</li> <li><code>splice</code>,</li> <li><code>sort</code>,</li> <li><code>reverse</code></li></ul> <h2 id="编译过程"><a href="#编译过程" class="header-anchor">#</a> 编译过程</h2> <p>想必大家在使用 Vue 开发的过程中，基本都是使用模板的方式。那么你有过「模板是怎么在浏览器中运行的」这种疑虑嘛？</p> <p>首先直接把模板丢到浏览器中肯定是不能运行的，模板只是为了方便开发者进行开发。Vue 会通过编译器将模板通过几个阶段最终编译为 render 函数，然后通过执行 render 函数生成 Virtual DOM 最终映射为真实 DOM。</p> <p>接下来我们就来学习这个编译的过程，了解这个过程中大概发生了什么事情。这个过程其中又分为三个阶段，分别为：</p> <p>将模板解析为 AST
优化 AST
将 AST 转换为 render 函数
在第一个阶段中，最主要的事情还是通过各种各样的正则表达式去匹配模板中的内容，然后将内容提取出来做各种逻辑操作，接下来会生成一个最基本的 AST 对象</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
<span class="token comment">// 类型</span>
type<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
<span class="token comment">// 标签</span>
tag<span class="token punctuation">,</span>
<span class="token comment">// 属性列表</span>
attrsList<span class="token punctuation">:</span> attrs<span class="token punctuation">,</span>
<span class="token comment">// 属性映射</span>
attrsMap<span class="token punctuation">:</span> <span class="token function">makeAttrsMap</span><span class="token punctuation">(</span>attrs<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token comment">// 父节点</span>
parent<span class="token punctuation">,</span>
<span class="token comment">// 子节点</span>
children<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后会根据这个最基本的 AST 对象中的属性，进一步扩展 AST。</p> <p>当然在这一阶段中，还会进行其他的一些判断逻辑。比如说对比前后开闭标签是否一致，判断根组件是否只存在一个，判断是否符合 HTML5 Content Model 规范等等问题。</p> <p>接下来就是优化 AST 的阶段。在当前版本下，Vue 进行的优化内容其实还是不多的。只是对节点进行了静态内容提取，也就是将永远不会变动的节点提取了出来，实现复用 Virtual DOM，跳过对比算法的功能。在下一个大版本中，Vue 会在优化 AST 的阶段继续发力，实现更多的优化功能，尽可能的在编译阶段压榨更多的性能，比如说提取静态的属性等等优化行为。</p> <p>最后一个阶段就是通过 AST 生成 render 函数了。其实这一阶段虽然分支有很多，但是最主要的目的就是遍历整个 AST，根据不同的条件生成不同的代码罢了。</p> <h2 id="nexttick-原理分析"><a href="#nexttick-原理分析" class="header-anchor">#</a> NextTick 原理分析</h2> <p>nextTick 可以让我们在下次 DOM 更新循环结束之后执行延迟回调，用于获得更新后的 DOM。</p> <p>在 Vue 2.4 之前都是使用的 microtasks，但是 microtasks 的优先级过高，在某些情况下可能会出现比事件冒泡更快的情况，但如果都使用 macrotasks 又可能会出现渲染的性能问题。所以在新版本中，会默认使用 microtasks，但在特殊情况下会使用 macrotasks，比如 v-on。</p> <p>对于实现 macrotasks ，会先判断是否能使用 setImmediate ，不能的话降级为 MessageChannel ，以上都不行的话就使用 setTimeout</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> setImmediate <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isNative</span><span class="token punctuation">(</span>setImmediate<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function-variable function">macroTimerFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token function">setImmediate</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>
	<span class="token keyword">typeof</span> MessageChannel <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span> <span class="token operator">&amp;&amp;</span>
	<span class="token punctuation">(</span><span class="token function">isNative</span><span class="token punctuation">(</span>MessageChannel<span class="token punctuation">)</span> <span class="token operator">||</span>
		<span class="token comment">// PhantomJS</span>
		MessageChannel<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;[object MessageChannelConstructor]&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> channel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MessageChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> port <span class="token operator">=</span> channel<span class="token punctuation">.</span>port2<span class="token punctuation">;</span>
	channel<span class="token punctuation">.</span>port1<span class="token punctuation">.</span>onmessage <span class="token operator">=</span> flushCallbacks<span class="token punctuation">;</span>
	<span class="token function-variable function">macroTimerFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		port<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
	<span class="token function-variable function">macroTimerFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">11/22/2019, 10:01:47 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/bufan-doc/interview/chrome/跨域.html" class="prev">
          跨域
        </a></span> <span class="next"><a href="/bufan-doc/interview/vue/项目问题及解决方法.html">
          Vue 项目常见问题及解决方法
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/bufan-doc/assets/js/app.f4cc6427.js" defer></script><script src="/bufan-doc/assets/js/4.d60abc91.js" defer></script><script src="/bufan-doc/assets/js/3.08e48031.js" defer></script><script src="/bufan-doc/assets/js/44.4675ab38.js" defer></script><script src="/bufan-doc/assets/js/14.618a24b7.js" defer></script>
  </body>
</html>
